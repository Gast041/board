{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- =========================
         СЛУЖЕБНЫЕ НАСТРОЙКИ СТРАНИЦЫ
         ========================= -->
    <meta charset="UTF-8">

    <!-- Заголовок вкладки браузера -->
    <title>{{ ad.title }}</title>

    <!-- Подключение общего CSS -->
    <link rel="stylesheet" href="{% static 'style.css' %}">

    <!-- Адаптивность -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<!-- =========================
     ШАПКА САЙТА
     ========================= -->
<header class="header">

    <!-- Логотип + ссылка на главную -->
    <div class="logo">
        <a href="/" style="text-decoration:none;color:#000;">
            Доска объявлений
        </a>
    </div>

    <!-- Меню справа -->
    <nav>
        {% if user.is_authenticated %}
            <span>{{ user.username }}</span>

            <form method="post" action="{% url 'logout' %}" style="display:inline;">
                {% csrf_token %}
                <button class="link-btn">Выйти</button>
            </form>
        {% else %}
            <a href="{% url 'login' %}">Вход</a>
            <a href="{% url 'signup' %}">Регистрация</a>
        {% endif %}
    </nav>

</header>


<!-- =========================
     ОСНОВНОЙ БЛОК
     ========================= -->
<main class="hero">

    <!-- Заголовок объявления -->
    <h1>{{ ad.title }}</h1>

    <!-- Цена -->
    {% if ad.price %}
        <div style="margin-bottom:15px; font-size:18px;">
            <b>Цена:</b> {{ ad.price }}
        </div>
    {% endif %}

    <!-- Описание -->
    {% if ad.description %}
        <div style="margin-bottom:20px;">
            {{ ad.description|linebreaksbr }}
        </div>
    {% else %}
        <div style="margin-bottom:20px; color:#444;">
            Описание не указано.
        </div>
    {% endif %}

    <!-- Автор -->
    <div style="font-size:14px; color:#444;">
        Автор: {{ ad.author.username }}
    </div>


    <!-- =========================
         КНОПКИ АВТОРА
         ========================= -->
    <!-- Показываются только автору -->
    {% if user.is_authenticated and user == ad.author %}
        <div style="margin-top:30px; display:flex; gap:12px; justify-content:center; flex-wrap:wrap;">

            <!-- =========================
                 КНОПКА РЕДАКТИРОВАНИЯ
                 ========================= -->
            <!-- Ведёт на: /ads/<id>/edit/ -->
            <a href="{% url 'edit_ad' ad.id %}" class="main-btn">
                Редактировать
            </a>


            <!-- =========================
                 КНОПКА УДАЛЕНИЯ
                 ========================= -->
            <!-- Удаление только через POST -->
            <form method="post"
                  action="{% url 'delete_ad' ad.id %}"
                  onsubmit="return confirm('Точно удалить объявление? Это действие нельзя отменить.');">
                {% csrf_token %}

                <button type="submit" class="danger-btn">
                    Удалить объявление
                </button>
            </form>

        </div>
    {% endif %}


    <!-- =========================
         КНОПКА НАЗАД
         ========================= -->
    <div style="margin-top:30px;">
        <a href="{% url 'ads_list' %}" class="main-btn">
            Назад к ленте
        </a>
    </div>

</main>

</body>
</html>
