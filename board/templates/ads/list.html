{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- –ö–æ–¥–∏—Ä–æ–≤–∫–∞ -->
    <meta charset="UTF-8">

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∫–ª–∞–¥–∫–∏ -->
    <title>–õ–µ–Ω—Ç–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</title>

    <!-- –û–±—â–∏–µ —Å—Ç–∏–ª–∏ —Å–∞–π—Ç–∞ -->
    <link rel="stylesheet" href="{% static 'style.css' %}">

    <!-- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<!-- =========================
     –®–ê–ü–ö–ê –°–ê–ô–¢–ê
     ========================= -->
<header class="header">

    <!-- –õ–ï–í–ê–Ø –ß–ê–°–¢–¨: –ª–æ–≥–æ—Ç–∏–ø -->
    <div class="logo">
        <a href="/" class="logo-link">52prime.ru</a>
    </div>

    <!-- –¶–ï–ù–¢–†: –ø–æ–∏—Å–∫ (–ª–æ–≥–∏–∫–∞ —É–∂–µ –≤ views: /ads/?q=...) -->
    <div class="header-search">
        <!-- –í–ê–ñ–ù–û: action –≤–µ–¥—ë–º –Ω–∞ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–µ–Ω—Ç—ã -->
        <form method="get" action="{% url 'ads_list' %}" class="search-form">

            <!-- –ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ -->
            <!-- value="{{ q }}" ‚Äî —á—Ç–æ–±—ã –≤–≤–µ–¥—ë–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è –ø–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞ -->
            <input
                type="text"
                name="q"
                value="{{ q|default:'' }}"
                placeholder="–ü–æ–∏—Å–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π..."
                class="search-input"
            >

            <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ -->
            <button type="submit" class="search-btn">
                –ù–∞–π—Ç–∏
            </button>

        </form>
    </div>

    <!-- –ü–†–ê–í–ê–Ø –ß–ê–°–¢–¨: –º–µ–Ω—é -->
    <nav class="header-nav">

        {% if user.is_authenticated %}

            <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è (–≤ —Å—Ç–∏–ª–µ —Å–∞–π—Ç–∞, –ù–ï –∑–µ–ª—ë–Ω–∞—è) -->
            <a class="main-btn" href="{% url 'create_ad' %}">
                + –û–±—ä—è–≤–ª–µ–Ω–∏–µ
            </a>

            <!-- –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <span class="header-user">{{ user.username }}</span>

            <!-- –í—ã—Ö–æ–¥ (POST) -->
            <form method="post" action="{% url 'logout' %}" style="display:inline;">
                {% csrf_token %}
                <button class="link-btn" type="submit">–í—ã–π—Ç–∏</button>
            </form>

        {% else %}

            <!-- –ï—Å–ª–∏ –Ω–µ –≤–æ—à—ë–ª -->
            <a href="{% url 'login' %}">–í—Ö–æ–¥</a>
            <a href="{% url 'signup' %}">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>

        {% endif %}

    </nav>

</header>


<!-- =========================
     –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢
     ========================= -->
<main class="hero">

    <h1>–õ–µ–Ω—Ç–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</h1>
    <p>–ù–æ–≤—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å–≤–µ—Ä—Ö—É</p>

    <!-- –ï—Å–ª–∏ —Å–µ–π—á–∞—Å –≤–∫–ª—é—á—ë–Ω –ø–æ–∏—Å–∫ ‚Äî –ø–æ–∫–∞–∂–µ–º —Å—Ç—Ä–æ–∫—É "–ü–æ–∏—Å–∫: ..." -->
    {% if q %}
        <div style="margin: 10px 0 20px; font-size: 14px;">
            <b>–ü–æ–∏—Å–∫:</b> {{ q }}
            ‚Ä¢
            <a href="{% url 'ads_list' %}" style="color:#c62828; text-decoration:none;">
                —Å–±—Ä–æ—Å–∏—Ç—å
            </a>
        </div>
    {% endif %}

    <!-- =========================
         –°–ü–ò–°–û–ö –û–ë–™–Ø–í–õ–ï–ù–ò–ô
         ========================= -->
    {% if ads %}

        <div style="text-align:left; display:grid; gap:14px;">

            {% for ad in ads %}
                <div style="border:1px solid #ffeded; padding:14px; border-radius:8px;">

                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞–∫ —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É -->
                    <div style="font-weight:bold; font-size:18px; margin-bottom:6px;">
                        <a href="{% url 'ad_detail' ad.id %}" class="ad-title-link">
                            {{ ad.title }}
                        </a>
                    </div>

                    {% if ad.price %}
                        <div style="margin-bottom:6px;">
                            <b>–¶–µ–Ω–∞:</b> {{ ad.price }}
                        </div>
                    {% endif %}

                    {% if ad.description %}
                        <div style="color:#000; margin-bottom:8px;">
                            {{ ad.description|truncatechars:150 }}
                        </div>
                    {% endif %}

                    <div style="margin-top:10px; font-size:13px; color:#444;">
                        –ê–≤—Ç–æ—Ä: {{ ad.author.username }}
                    </div>

                </div>
            {% endfor %}

        </div>

    {% else %}
        <p>–ü–æ–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–µ—Ç. –ë—É–¥—å –ø–µ—Ä–≤—ã–º üôÇ</p>
    {% endif %}

</main>

</body>
</html>
